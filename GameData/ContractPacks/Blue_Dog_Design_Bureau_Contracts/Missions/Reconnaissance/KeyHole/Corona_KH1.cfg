CONTRACT_TYPE
{
    name = Corona_KH1
    group = CoronaProgram
	title = Perform photo reconnaissance from a polar orbit of @targetBody.

	description = The CORONA program started under the name "Discoverer" as part of the WS-117L satellite reconnaissance and protection program of the U.S. Air Force The primary goal of the program was to develop a film-return photographic satellite to replace the U-2 spyplane in surveilling the Sino-Soviet Bloc, determining the disposition and speed of production of Soviet missiles and long-range bombers assets. The CORONA program was also used to produce maps and charts for the Department of Defense and other U.S. government mapping programs. Our first satellite is designated KH-1. KH stood for "Key Hole" with the name being an analogy to the act of spying into a person's room by peering through their door's keyhole. The KH-1 payload consists of the C (Corona) single panoramic camera and a single General Electric return vehicle (SRV, Satellite Return Vehicle). The satellite was based on the Agena-A upper stage, which provides attitude control in orbit. The film return capsule carries its own small solid-fuel retro motor to deorbit at the end of the mission with mid-air recovery of the returning capsule by a specially equipped aircraft.

	notes = The KH-1 satellite was first successfully launched by a Thor-Agena on April 13, 1959 as Discoverer 2 from the Vandenberg AFB Launch Complex.
    synopsis = <color=yellow>Launch a Keyhole KH-1 recon satellite into space around @targetBody and perform photo recon of the specified areas.</color>
    completedMessage = Mission Success!.

    agent = nro
    maxSimultaneous = 1
	maxCompletions = 10 //10 Launches
    deadline = 0
	minExpiry = 0
	maxExpiry = 0
	
	advanceFunds = @Blue_Dog_Design_Bureau_Contracts:Kerbucks025
    rewardFunds = Random(@Blue_Dog_Design_Bureau_Contracts:Kerbucks1,@Blue_Dog_Design_Bureau_Contracts:Kerbucks105)
    rewardReputation = Random(4.0, 8.0)
	rewardScience = 4

    targetBody = HomeWorld()
	
    // Hardcoded list of specific experiments
    DATA
    {
        name = experimentslist
		title = experimentslist
		type = List<ScienceExperiment>
        hidden = true

        experiments = [bd_mapping]
    }
	
	// Randomly select 1 valid biome to study from low space.
    DATA
    {
		type = List<ScienceSubject>
        hidden = true

        scienceSubjectsTemp1 = AllScienceSubjectsByBodyExperiment([@targetBody], @experiments)
		scienceSubjectsTemp2 = @scienceSubjectsTemp1.Where(s => !s.Biome().IsKSC())
		scienceSubjectsTemp3 = @scienceSubjectsTemp2.Where(s => s.Situation() == InSpaceLow)
        scienceSubjects = @scienceSubjectsTemp3.Random(1)
    }
	
	PARAMETER
    {
        name = KH-1 Recon Satellite
        type = VesselParameterGroup
        title = Launch a new KH-1 recon satellite
		
		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = The satellite must be a new vessel
		}
		
		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
		}

		// Required Parts ---------------------------------
		PARAMETER
		{
			type = PartValidation
			part = bluedog_Corona_Pod
			disableOnStateChange = True
		}
		PARAMETER
		{
			type = PartValidation
			part = bluedog_Keyhole_Camera_KH1
			disableOnStateChange = True
		}
		// /Required Parts ---------------------------------

        // Orbit
		PARAMETER
		{
			name = Orbit
			type = Orbit
			title = Achieve the specified polar low space orbit
			
			maxApA = @targetBody.SpaceAltitudeThreshold()
			minInclination = Random(70,85)
			maxInclination = Random(90,105)
			disableOnStateChange = true
		}
	}

	PARAMETER
	{
		name = CollectScience
		type = CollectScience

		title = Take a photo of the specified area
		biome = @scienceSubject.Biome()
		situation = @scienceSubject.Situation()
		experiment = @scienceSubject.Experiment()
		recoveryMethod = Recover

		ITERATOR
		{
			type = ScienceSubject
			scienceSubject = @/scienceSubjects
		}
	}
	
	PARAMETER
	{
		name = ReturnHome
		type = ReturnHome
		title = Recover the film canister
	}

	// Must have flown Explorer 1 and Thor DM-18 test flight
	REQUIREMENT
	{
        name = CompleteContract
        type = CompleteContract
        contractType = Explorer-1
        minCount =1
        maxCount =1
        cooldownDuration = 0d
	}

	REQUIREMENT
	{
        name = CompleteContract
        type = CompleteContract
        contractType = Pioneer-1
        minCount =1
        maxCount =1
        cooldownDuration = 0d
	}

	// Deactivate this if a KH-4 mission is flown
	REQUIREMENT
    {
        name = Any
		type = Any
		invertRequirement = true
		
		REQUIREMENT
        {
            name = CompleteContract
            type = CompleteContract
            contractType = Corona_KH4
            minCount = 1
            cooldownDuration = 0d
        }
    }
}
